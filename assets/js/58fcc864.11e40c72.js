"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9798],{2362:(e,n,t)=>{t.d(n,{A:()=>B});var o=t(6540),i=t(4848);function s(e){const{mdxAdmonitionTitle:n,rest:t}=function(e){const n=o.Children.toArray(e),t=n.find((e=>o.isValidElement(e)&&"mdxAdmonitionTitle"===e.type)),s=n.filter((e=>e!==t)),r=t?.props.children;return{mdxAdmonitionTitle:r,rest:s.length>0?(0,i.jsx)(i.Fragment,{children:s}):null}}(e.children),s=e.title??n;return{...e,...s&&{title:s},children:t}}var r=t(8215),a=t(539),c=t(204);const l="admonition_xJq3",d="admonitionHeading_Gvgb",h="admonitionIcon_Rf37",u="admonitionContent_BuS1";function m({type:e,className:n,children:t}){return(0,i.jsx)("div",{className:(0,r.A)(c.G.common.admonition,c.G.common.admonitionType(e),l,n),children:t})}function p({icon:e,title:n}){return(0,i.jsxs)("div",{className:d,children:[(0,i.jsx)("span",{className:h,children:e}),n]})}function x({children:e}){return e?(0,i.jsx)("div",{className:u,children:e}):null}function f(e){const{type:n,icon:t,title:o,children:s,className:r}=e;return(0,i.jsxs)(m,{type:n,className:r,children:[o||t?(0,i.jsx)(p,{title:o,icon:t}):null,(0,i.jsx)(x,{children:s})]})}function v(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"})})}const g={icon:(0,i.jsx)(v,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.note",description:"The default label used for the Note admonition (:::note)",children:"note"})};function w(e){return(0,i.jsx)(f,{...g,...e,className:(0,r.A)("alert alert--secondary",e.className),children:e.children})}function y(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"})})}const j={icon:(0,i.jsx)(y,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.tip",description:"The default label used for the Tip admonition (:::tip)",children:"tip"})};function b(e){return(0,i.jsx)(f,{...j,...e,className:(0,r.A)("alert alert--success",e.className),children:e.children})}function k(e){return(0,i.jsx)("svg",{viewBox:"0 0 14 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"})})}const N={icon:(0,i.jsx)(k,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.info",description:"The default label used for the Info admonition (:::info)",children:"info"})};function A(e){return(0,i.jsx)(f,{...N,...e,className:(0,r.A)("alert alert--info",e.className),children:e.children})}function C(e){return(0,i.jsx)("svg",{viewBox:"0 0 16 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"})})}const T={icon:(0,i.jsx)(C,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.warning",description:"The default label used for the Warning admonition (:::warning)",children:"warning"})};function R(e){return(0,i.jsx)("svg",{viewBox:"0 0 12 16",...e,children:(0,i.jsx)("path",{fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"})})}const z={icon:(0,i.jsx)(R,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.danger",description:"The default label used for the Danger admonition (:::danger)",children:"danger"})};const M={icon:(0,i.jsx)(C,{}),title:(0,i.jsx)(a.A,{id:"theme.admonition.caution",description:"The default label used for the Caution admonition (:::caution)",children:"caution"})};const S={...{note:w,tip:b,info:A,warning:function(e){return(0,i.jsx)(f,{...T,...e,className:(0,r.A)("alert alert--warning",e.className),children:e.children})},danger:function(e){return(0,i.jsx)(f,{...z,...e,className:(0,r.A)("alert alert--danger",e.className),children:e.children})}},...{secondary:e=>(0,i.jsx)(w,{title:"secondary",...e}),important:e=>(0,i.jsx)(A,{title:"important",...e}),success:e=>(0,i.jsx)(b,{title:"success",...e}),caution:function(e){return(0,i.jsx)(f,{...M,...e,className:(0,r.A)("alert alert--warning",e.className),children:e.children})}}};function B(e){const n=s(e),t=(o=n.type,S[o]||(console.warn(`No admonition component found for admonition type "${o}". Using Info as fallback.`),S.info));var o;return(0,i.jsx)(t,{...n})}},2867:(e,n,t)=>{t.d(n,{A:()=>o});const o=t.p+"assets/medias/task-list-sync-8b4592fc5718f85e407172bca42a9c13.webm"},3358:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var o=t(4848);function i({src:e,alt:n,caption:t,type:i}){return"video"===i?(0,o.jsxs)("figure",{className:"figure",children:[(0,o.jsx)("video",{src:e}),(0,o.jsx)("figcaption",{children:t})]}):(0,o.jsxs)("figure",{className:"figure",children:[(0,o.jsx)("img",{src:e,alt:n}),(0,o.jsx)("figcaption",{children:t})]})}},3476:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var o=t(4848);function i({children:e}){return(0,o.jsxs)("div",{className:"exercise",children:[(0,o.jsx)("div",{className:"exercise-header",children:(0,o.jsx)("h3",{children:"Exercise"})}),(0,o.jsx)("div",{className:"exercise-content",children:e})]})}},4903:(e,n,t)=>{t.d(n,{A:()=>i});t(6540);var o=t(4848);function i({children:e}){return(0,o.jsxs)("div",{className:"solution",children:[(0,o.jsx)("div",{className:"solution-header",children:(0,o.jsx)("h4",{children:"Solution"})}),(0,o.jsx)("div",{className:"solution-content",children:e})]})}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(6540);const i={},s=o.createContext(i);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(s.Provider,{value:n},e.children)}},8480:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>m,contentTitle:()=>u,default:()=>f,frontMatter:()=>h,metadata:()=>o,toc:()=>p});const o=JSON.parse('{"id":"tutorial/network-sync","title":"Network Sync","description":"Collaborating over the internet","source":"@site/docs/tutorial/06-network-sync.mdx","sourceDirName":"tutorial","slug":"/tutorial/network-sync","permalink":"/docs/tutorial/network-sync","draft":false,"unlisted":false,"editUrl":"https://github.com/automerge/automerge.github.io/edit/main/docs/tutorial/06-network-sync.mdx","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"Network Sync"},"sidebar":"tutorialSidebar","previous":{"title":"React Integration","permalink":"/docs/tutorial/react"},"next":{"title":"Multiple Task Lists","permalink":"/docs/tutorial/multiple-task-lists"}}');var i=t(4848),s=t(8453),r=t(2362),a=t(3476),c=t(4903),l=t(3358),d=t(2867);const h={title:"Network Sync"},u=void 0,m={},p=[{value:"Collaborating over the internet",id:"collaborating-over-the-internet",level:2},{value:"Connect to a sync server via a websocket",id:"connect-to-a-sync-server-via-a-websocket",level:4},{value:"Network Not Required",id:"network-not-required",level:2}];function x(e){const n={code:"code",em:"em",h2:"h2",h4:"h4",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"collaborating-over-the-internet",children:"Collaborating over the internet"}),"\n",(0,i.jsx)(n.p,{children:"Thus far, we've been using the BroadcastChannel NetworkAdapter to move data between tabs in the same browser. Automerge treats all network adapters similarly: they are just peers you may choose to synchronize documents with."}),"\n",(0,i.jsx)(n.p,{children:"One straightforward way of getting data to other people is to send it to the cloud; then they can come along and fetch the data at their leisure."}),"\n",(0,i.jsx)(n.p,{children:'When you configure automerge to run on an internet server, listen for connections, and store data on disk, then we call that a "sync server". There\'s nothing really special about a sync server: it runs the exact same version of Auotmerge as you run locally. With a little configuration work, you could even connect to multiple sync servers and choose what data you want to send.'}),"\n",(0,i.jsxs)(n.p,{children:["The Automerge team provides a public community sync server at ",(0,i.jsx)(n.code,{children:"wss://sync.automerge.org"}),'. For production software, you should run your own server, but for prototyping and development you are welcome to use ours on an "as-is" basis.']}),"\n",(0,i.jsxs)(a.A,{children:[(0,i.jsx)(n.h4,{id:"connect-to-a-sync-server-via-a-websocket",children:"Connect to a sync server via a websocket"}),(0,i.jsxs)(n.p,{children:["This is as simple as adding ",(0,i.jsx)(n.code,{children:"WebSocketClientAdapter"})," to your Repo's network subsystem. We'll do this at creation time, but remember you can add and remove adapters later, too."]}),(0,i.jsx)(c.A,{children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",metastring:'title="src/main.tsx"',children:'//...\n// highlight-next-line\nimport { WebSocketClientAdapter } from "@automerge/react";\n\nconst repo = new Repo({\n  network: [\n    new BroadcastChannelNetworkAdapter(),\n    // highlight-next-line\n    new WebSocketClientAdapter("wss://sync.automerge.org"),\n  ],\n  storage: new IndexedDBStorageAdapter(),\n});\n'})})})]}),"\n",(0,i.jsxs)(n.p,{children:["Now, when the Repo sees any changes it will sync them not only locally via the BroadcastChannel, but also over a websocket connection to ",(0,i.jsx)(n.code,{children:"sync.automerge.org"}),", and any other process can connect to that server and use the URL to get the changes we've made."]}),"\n",(0,i.jsx)(r.A,{type:"caution",children:(0,i.jsxs)(n.p,{children:["The Automerge project provides a public sync server for you to experiment with, at ",(0,i.jsx)(n.code,{children:"sync.automerge.org"}),". This is not a private instance, and as an experimental service has no reliability or data safety guarantees. Feel free to use it for demos and prototyping, but run your own sync server for production apps."]})}),"\n",(0,i.jsxs)(n.p,{children:["To see this in action, open the same URL (including the document ID) in a different browser, or on a different device. Unlike the local-only version, you'll now see the data updates synced across ",(0,i.jsx)(n.em,{children:"all"})," open clients."]}),"\n",(0,i.jsx)(l.A,{src:d.A,type:"video",alt:'Screen capture of two browser windows side-by-side showing the same app titled "Automerge Task List". As the user clicks buttons, enters text or checks boxes in one window, their changes show up immediately in the other window.',caption:"Local collaboration via the BroadcastChannelNetworkAdapter"}),"\n",(0,i.jsx)(n.h2,{id:"network-not-required",children:"Network Not Required"}),"\n",(0,i.jsx)(n.p,{children:"Now that the Repo is syncing changes remotely, what happens when the websocket connection is unavailable?"}),"\n",(0,i.jsxs)(n.p,{children:["Since the repo stores documents locally with the ",(0,i.jsx)(n.code,{children:"IndexedDBStorageAdapter"}),", methods like ",(0,i.jsx)(n.code,{children:"Repo.find"})," will consult local storage to retrieve/modify documents, so clients can create new documents while disconnected, and any clients who've already loaded a given document will still be able to make changes to it while offline."]}),"\n",(0,i.jsx)(n.p,{children:"Once connectivity has been re-established, the Repo will sync any local changes with those from remote peers, so everyone ultimately sees the same data."}),"\n",(0,i.jsx)(n.p,{children:"Go ahead and experiment with this by opening your site in two browsers, turning off wifi, making some changes, and turning it back on."})]})}function f(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(x,{...e})}):x(e)}}}]);